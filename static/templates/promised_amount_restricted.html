{{define "PromisedAmountRestricted"}}
<script>

function freecoin_process( first ) {
	$.post( 'ajax?controllerName=freecoinProcess', {first: first}, function (ret) {
		data = JSON.parse( ret );
		if (data.status == 'reload') {
			$("#freewait").hide();
			$("#freesent").hide();
			$("#getCoins").show();
			return;
		} else if (data.status == 'error') {
			$("#freewait").hide();
			$("#freesent").hide();
			$("#getCoins").show();
			return;
		} else if (data.status == 'success') {
			dc_navigate ('miningMenu', {} );
			return;
		}
		setTimeout( function(){ freecoin_process( false )}, 2000 );
	});
}

	$('#getCoins').bind('click', function () {

		{{if .ShowSignData}}$("#main_data").css("display", "none"); $("#sign").css("display", "block");{{end}}
		$("#for-signature").val( '{{.TxTypeId}},{{.TimeNow}},{{.UserId}},72,30');
		doSign();
		{{if not .ShowSignData}}$("#send_to_net").trigger("click");{{end}}
		});

		$('#send_to_net').bind('click', function () {

			$.post( 'ajax?controllerName=saveQueue', {
						'type' : '{{.TxType}}',
						'time' : '{{.TimeNow}}',
						'user_id' : '{{.UserId}}',
						'currency_id' : 72,
						'amount' : 30,
						'signature1': $('#signature1').val(),
						'signature2': $('#signature2').val(),
						'signature3': $('#signature3').val()
					}, function (data) {
//						dc_navigate ('miningMenu', {'alert': '{{.Lang.sent_to_the_net}}'} );
						$("#getCoins").hide();
						$("#freewait").show();
						$("#freesent").show();
						setTimeout( function(){ freecoin_process( true )}, 2000 );
					}
			);
		});


</script>
<h1 class="page-header">Mining</h1>

{{template "alertSuccess".}}
{{if .Alert}}
<img src="/static/img/load.gif">
{{else}}
<div id="freesent" style="display: none;" class="alert alert-success"><button type="button" class="close" data-dismiss="alert">&times;</button>{{.Lang.sent_to_the_net}}</div>
<img id="freewait" src="/static/img/load.gif" style="display: none;">
<button id="getCoins" class="btn btn-primary">Get FREE coins</button>
{{end}}
{{template "signatures".}}

<script>
	//doSign();
</script>
{{end}}